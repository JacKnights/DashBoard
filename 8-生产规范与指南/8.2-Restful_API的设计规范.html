<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>EasyOrder | Restful API 的设计规范</title>
    <meta name="description" content="DashBoard">
    
    
    <link rel="preload" href="/DashBoard/assets/css/56.styles.500ee7d6.css" as="style"><link rel="preload" href="/DashBoard/assets/js/app.375a5640.js" as="script"><link rel="preload" href="/DashBoard/assets/js/16.7152cef1.js" as="script"><link rel="prefetch" href="/DashBoard/assets/js/1.815d076e.js"><link rel="prefetch" href="/DashBoard/assets/js/0.fc47b4cd.js"><link rel="prefetch" href="/DashBoard/assets/js/2.8a1c31ae.js"><link rel="prefetch" href="/DashBoard/assets/js/3.fb8a6b2e.js"><link rel="prefetch" href="/DashBoard/assets/js/4.49b43a79.js"><link rel="prefetch" href="/DashBoard/assets/js/5.d50f8be1.js"><link rel="prefetch" href="/DashBoard/assets/js/6.8b5b7547.js"><link rel="prefetch" href="/DashBoard/assets/js/7.49ceb857.js"><link rel="prefetch" href="/DashBoard/assets/js/8.b5223fec.js"><link rel="prefetch" href="/DashBoard/assets/js/9.515fb130.js"><link rel="prefetch" href="/DashBoard/assets/js/10.7aa2362b.js"><link rel="prefetch" href="/DashBoard/assets/js/11.301a4780.js"><link rel="prefetch" href="/DashBoard/assets/js/12.54f44ffe.js"><link rel="prefetch" href="/DashBoard/assets/js/13.bf54bf21.js"><link rel="prefetch" href="/DashBoard/assets/js/14.19f2640e.js"><link rel="prefetch" href="/DashBoard/assets/js/15.84f54907.js"><link rel="prefetch" href="/DashBoard/assets/js/17.45264804.js"><link rel="prefetch" href="/DashBoard/assets/js/18.3f88abd3.js"><link rel="prefetch" href="/DashBoard/assets/js/19.399c13a6.js"><link rel="prefetch" href="/DashBoard/assets/js/20.a9bb35ac.js"><link rel="prefetch" href="/DashBoard/assets/js/21.8a2830a9.js"><link rel="prefetch" href="/DashBoard/assets/js/22.3ab047b0.js"><link rel="prefetch" href="/DashBoard/assets/js/23.1927407e.js"><link rel="prefetch" href="/DashBoard/assets/js/24.ece0962a.js"><link rel="prefetch" href="/DashBoard/assets/js/25.de82bea7.js"><link rel="prefetch" href="/DashBoard/assets/js/26.af5405ff.js"><link rel="prefetch" href="/DashBoard/assets/js/27.137a5779.js"><link rel="prefetch" href="/DashBoard/assets/js/28.6ba32fde.js"><link rel="prefetch" href="/DashBoard/assets/js/29.37dca81b.js"><link rel="prefetch" href="/DashBoard/assets/js/30.faf971a3.js"><link rel="prefetch" href="/DashBoard/assets/js/31.20284640.js"><link rel="prefetch" href="/DashBoard/assets/js/32.effb84d0.js"><link rel="prefetch" href="/DashBoard/assets/js/33.63c939d0.js"><link rel="prefetch" href="/DashBoard/assets/js/34.409d93f8.js"><link rel="prefetch" href="/DashBoard/assets/js/35.a9fdc604.js"><link rel="prefetch" href="/DashBoard/assets/js/36.26076c3c.js"><link rel="prefetch" href="/DashBoard/assets/js/37.4ef3ce41.js"><link rel="prefetch" href="/DashBoard/assets/js/38.5af51780.js"><link rel="prefetch" href="/DashBoard/assets/js/39.875be6be.js"><link rel="prefetch" href="/DashBoard/assets/js/40.2325c3cc.js"><link rel="prefetch" href="/DashBoard/assets/js/41.034fe344.js"><link rel="prefetch" href="/DashBoard/assets/js/42.24a5121d.js"><link rel="prefetch" href="/DashBoard/assets/js/43.ef1fb67c.js"><link rel="prefetch" href="/DashBoard/assets/js/44.367c9ef6.js"><link rel="prefetch" href="/DashBoard/assets/js/45.74a9a887.js"><link rel="prefetch" href="/DashBoard/assets/js/46.7aa6db16.js"><link rel="prefetch" href="/DashBoard/assets/js/47.3b607220.js"><link rel="prefetch" href="/DashBoard/assets/js/48.52f6afc8.js"><link rel="prefetch" href="/DashBoard/assets/js/49.2a856fae.js"><link rel="prefetch" href="/DashBoard/assets/js/50.63e871d0.js"><link rel="prefetch" href="/DashBoard/assets/js/51.93ca4349.js"><link rel="prefetch" href="/DashBoard/assets/js/52.380aec7e.js"><link rel="prefetch" href="/DashBoard/assets/js/53.9d6f4050.js"><link rel="prefetch" href="/DashBoard/assets/js/54.cd5b57ab.js"><link rel="prefetch" href="/DashBoard/assets/js/55.7dff6ce7.js">
    <link rel="stylesheet" href="/DashBoard/assets/css/56.styles.500ee7d6.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container no-sidebar"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div><a href="/DashBoard/" class="home-link router-link-active"><!----><span class="site-name">
      EasyOrder
    </span></a><div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""><!----></div><nav class="nav-links can-hide"><div class="nav-item"><a href="/DashBoard/X3_Final_report.html" class="nav-link">期末总结</a></div><div class="nav-item"><a href="/DashBoard/2-Team_profile.html" class="nav-link">团队组员</a></div><div class="nav-item"><a href="/DashBoard/7-Design/7.3-API设计/" class="nav-link">API</a></div><div class="nav-item"><a href="https://github.com/OOAD-Project" target="_blank" rel="noopener noreferrer" class="nav-link">Github</a></div><!----></nav></div></header><div class="sidebar-mask"></div><div class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/DashBoard/X3_Final_report.html" class="nav-link">期末总结</a></div><div class="nav-item"><a href="/DashBoard/2-Team_profile.html" class="nav-link">团队组员</a></div><div class="nav-item"><a href="/DashBoard/7-Design/7.3-API设计/" class="nav-link">API</a></div><div class="nav-item"><a href="https://github.com/OOAD-Project" target="_blank" rel="noopener noreferrer" class="nav-link">Github</a></div><!----></nav><!----></div><div class="page"><div class="content"><h1 id="restful-api-的设计规范"><a href="#restful-api-的设计规范" aria-hidden="true" class="header-anchor">#</a> Restful API 的设计规范</h1><h2 id="uri"><a href="#uri" aria-hidden="true" class="header-anchor">#</a> URI</h2><ol><li>不用大写；</li><li>用中杠-不用下杠_；</li><li>参数列表要encode；</li><li>URI中的名词表示资源集合，使用复数形式。</li><li>避免层级过深的URI。过深的导航容易导致url膨胀，不易维护。</li><li>服务器端的组合实体必须在uri中通过父实体的id导航访问。</li></ol><h2 id="request"><a href="#request" aria-hidden="true" class="header-anchor">#</a> Request</h2><ul><li>GET (SELECT)：从服务器检索特定资源，或资源列表。</li><li>POST (CREATE)：在服务器上创建一个新的资源。</li><li>PUT (UPDATE)：更新服务器上的资源，提供整个资源。</li><li>DELETE (DELETE)：从服务器删除资源。</li></ul><h2 id="安全性和幂等性"><a href="#安全性和幂等性" aria-hidden="true" class="header-anchor">#</a> 安全性和幂等性</h2><ul><li><strong>安全性</strong> ：不会改变资源状态，可以理解为只读的</li><li><strong>幂等性</strong> ：执行1次和执行N次，对资源状态改变的效果是等价的</li></ul><table><thead><tr><th style="text-align:center">方法</th><th style="text-align:center">安全性</th><th style="text-align:center">幂等性</th></tr></thead><tbody><tr><td style="text-align:center">GET</td><td style="text-align:center">√</td><td style="text-align:center">√</td></tr><tr><td style="text-align:center">POST</td><td style="text-align:center">×</td><td style="text-align:center">×</td></tr><tr><td style="text-align:center">PUT</td><td style="text-align:center">×</td><td style="text-align:center">√</td></tr><tr><td style="text-align:center">DELETE</td><td style="text-align:center">×</td><td style="text-align:center">√</td></tr></tbody></table><p>安全性和幂等性均不保证反复请求能拿到相同的response。以 DELETE 为例，第一次DELETE返回200表示删除成功，第二次返回404提示资源不存在，这是允许的。</p><h2 id="复杂查询"><a href="#复杂查询" aria-hidden="true" class="header-anchor">#</a> 复杂查询</h2><table><thead><tr><th style="text-align:center">参数形式</th><th style="text-align:center">示例</th><th style="text-align:center">备注</th></tr></thead><tbody><tr><td style="text-align:center">过滤条件</td><td style="text-align:center"><code>?type=1&amp;age=16</code></td><td style="text-align:center">允许一定的uri冗余，如/zoos/1与/zoos?id=1</td></tr><tr><td style="text-align:center">排序</td><td style="text-align:center"><code>?sort=age,desc</code></td><td style="text-align:center"></td></tr><tr><td style="text-align:center">投影</td><td style="text-align:center"><code>?whitelist=id,name,email</code></td><td style="text-align:center"></td></tr><tr><td style="text-align:center">分页</td><td style="text-align:center"><code>?limit=10&amp;offset=3</code></td><td style="text-align:center"></td></tr></tbody></table><h2 id="format"><a href="#format" aria-hidden="true" class="header-anchor">#</a> Format</h2><ul><li><p>Content-Type: application/json</p><pre class="language-typescript"><code>  <span class="token constant">POST</span> <span class="token operator">/</span>v1<span class="token operator">/</span>animal <span class="token constant">HTTP</span><span class="token operator">/</span><span class="token number">1.1</span>
  Host<span class="token punctuation">:</span> api<span class="token punctuation">.</span>example<span class="token punctuation">.</span>org
  Accept<span class="token punctuation">:</span> application<span class="token operator">/</span>json
  Content<span class="token operator">-</span>Type<span class="token punctuation">:</span> application<span class="token operator">/</span>json
  Content<span class="token operator">-</span>Length<span class="token punctuation">:</span> <span class="token number">24</span>

  <span class="token punctuation">{</span>   
  	<span class="token string">&quot;name&quot;</span><span class="token punctuation">:</span> <span class="token string">&quot;Gir&quot;</span><span class="token punctuation">,</span>
  	<span class="token string">&quot;animalType&quot;</span><span class="token punctuation">:</span> <span class="token string">&quot;12&quot;</span>
  <span class="token punctuation">}</span>
</code></pre></li><li><p>Content-Type: application/x-www-form-urlencoded (浏览器POST表单用的格式)</p><pre class="language-typescript"><code><span class="token constant">POST</span> <span class="token operator">/</span>login <span class="token constant">HTTP</span><span class="token operator">/</span><span class="token number">1.1</span>
Host<span class="token punctuation">:</span> example<span class="token punctuation">.</span>com
Content<span class="token operator">-</span>Length<span class="token punctuation">:</span> <span class="token number">31</span>
Accept<span class="token punctuation">:</span> text<span class="token operator">/</span>html
Content<span class="token operator">-</span>Type<span class="token punctuation">:</span> application<span class="token operator">/</span>x<span class="token operator">-</span>www<span class="token operator">-</span>form<span class="token operator">-</span>urlencoded

username<span class="token operator">=</span>root<span class="token operator">&amp;</span>password<span class="token operator">=</span>Zion0101
</code></pre></li><li><p>Content-Type: multipart/form-data; boundary=—-RANDOM_jDMUxq4Ot5 (表单有文件上传时的格式)</p></li></ul><h2 id="response"><a href="#response" aria-hidden="true" class="header-anchor">#</a> Response</h2><ol><li><p>不要包装：response 的 body 直接就是数据，不要做多余的包装。</p></li><li><p>各HTTP方法成功处理后的数据格式：</p><table><thead><tr><th style="text-align:center">方法</th><th style="text-align:center">response 格式</th></tr></thead><tbody><tr><td style="text-align:center">GET</td><td style="text-align:center">单个对象、集合</td></tr><tr><td style="text-align:center">POST</td><td style="text-align:center">新增成功的对象</td></tr><tr><td style="text-align:center">PUT</td><td style="text-align:center">更新成功的对象</td></tr><tr><td style="text-align:center">DELETE</td><td style="text-align:center">空</td></tr></tbody></table></li><li><p>json格式的约定：</p><ol><li>时间用长整形(毫秒数)，客户端自己按需解析（moment.js）</li><li>不传null字段</li></ol></li></ol><h2 id="错误处理"><a href="#错误处理" aria-hidden="true" class="header-anchor">#</a> 错误处理</h2><ol><li>不要发生了错误但给2xx响应，客户端可能会缓存成功的http请求；</li><li>正确设置http状态码，不要自定义；</li><li>Response body 提供 1) 错误的代码（日志/问题追查）；2) 错误的描述文本（展示给用户）。</li></ol><p>业务类异常必须提供2种信息：</p><ol><li>如果抛出该类异常，HTTP 响应状态码应该设成什么；</li><li>异常的文本描述；</li></ol><p>在Controller层使用统一的异常拦截器：</p><ol><li>设置 HTTP 响应状态码：对业务类异常，用它指定的 HTTP code；对非业务类异常，统一500；</li><li>Response Body 的错误码：异常类名</li><li>Response Body 的错误描述：对业务类异常，用它指定的错误文本；对非业务类异常，线上可以统一文案如“服务器端错误，请稍后再试”，开发或测试环境中用异常的 stacktrace，服务器端提供该行为的开关</li></ol><p>常用的http状态码及使用场景：</p><table><thead><tr><th style="text-align:center">状态码</th><th style="text-align:center">使用场景</th></tr></thead><tbody><tr><td style="text-align:center">400 bad request</td><td style="text-align:center">常用在参数校验</td></tr><tr><td style="text-align:center">401 unauthorized</td><td style="text-align:center">未经验证的用户，常见于未登录。如果经过验证后依然没权限，应该 403（即 authentication 和 authorization 的区别）。</td></tr><tr><td style="text-align:center">403 forbidden</td><td style="text-align:center">无权限</td></tr><tr><td style="text-align:center">404 not found</td><td style="text-align:center">资源不存在</td></tr><tr><td style="text-align:center">500 internal server error</td><td style="text-align:center">非业务类异常</td></tr><tr><td style="text-align:center">503 service unavaliable</td><td style="text-align:center">由容器抛出，自己的代码不要抛这个异常</td></tr></tbody></table><h2 id="参考文档"><a href="#参考文档" aria-hidden="true" class="header-anchor">#</a> 参考文档</h2><ol><li><a href="http://novoland.github.io/%E8%AE%BE%E8%AE%A1/2015/08/17/Restful%20API%20%E7%9A%84%E8%AE%BE%E8%AE%A1%E8%A7%84%E8%8C%83.html" target="_blank" rel="noopener noreferrer">Restful API 的设计规范</a></li><li><a href="https://www.jianshu.com/p/8b769356ee67" target="_blank" rel="noopener noreferrer">restful接口设计规范总结</a></li></ol></div><!----><!----></div></div></div>
    <script src="/DashBoard/assets/js/16.7152cef1.js" defer></script><script src="/DashBoard/assets/js/app.375a5640.js" defer></script>
  </body>
</html>
